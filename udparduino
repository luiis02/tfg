#include <WiFi.h>
#include <WiFiUdp.h>

// Configura los detalles de la red WiFi
const char* ssid = "TP-Link_C7D4";
const char* password = "56027563";

// Configura el pin del micrófono y el búfer
const int micPin = 34; 
const int sampleRate = 16000;  
const int duration = 2;  
const int bufferSize = sampleRate * duration;  
int16_t buffer[bufferSize];

WiFiUDP udp;

void setup() {
  Serial.begin(115200);
  analogReadResolution(12); 
  WiFi.begin(ssid, password);
  while (WiFi.status() != WL_CONNECTED) {
    delay(1000);
  }
}

void loop() {
  for (int i = 0; i < bufferSize; i++) {
    buffer[i] = analogRead(micPin);
    delayMicroseconds(1000000 / sampleRate);
  }

  if (WiFi.status() == WL_CONNECTED) {
    udp.beginPacket("192.168.0.2", 1234);  
    udp.write((uint8_t*)buffer, bufferSize * sizeof(int16_t));
    udp.endPacket();
  }
}
